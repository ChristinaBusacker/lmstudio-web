<div
  class="diagram-host"
  (mousemove)="onDiagramMouseMove($event)"
  (pointerdown)="onDiagramPointerDown($event)"
>
  @if (workflow$ | async; as wf) {
    <ng-diagram
      class="diagram"
      [model]="model"
      [config]="config"
      [nodeTemplateMap]="nodeTemplateMap"
      (diagramInit)="onDiagramInit()"
      (edgeDrawn)="onEdgeDrawn()"
      (selectionMoved)="onSelectionMoved()"
    >
      <ng-diagram-background />
    </ng-diagram>

    <div class="controls">
      <button class="btn" (click)="addNode('llm')"><app-icon name="add-line" /> Add</button>

      <button class="btn btn-primary" (click)="saveGraph()" [disabled]="!editorDirty()">
        <app-icon name="save-line" /> Save
      </button>

      <button class="btn btn-accent" (click)="startRun(wf.id)">
        <app-icon name="play-line" /> Run
      </button>
    </div>

    <app-workflow-run-list-container class="runs-panel" />
  }
</div>
